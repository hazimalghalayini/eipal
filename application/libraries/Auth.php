<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');define("CUSTOM_THEME", Auth::getTheme());class Auth {    protected $CI;    function __construct() {        $this->CI = & get_instance();    }    function is_logged_in() {        $is_logged_in = $this->CI->session->userdata('is_logged_in');        if (!isset($is_logged_in) || $is_logged_in != TRUE) {            redirect(base_url() . 'admin/users/login', 'location');        }        return true;    }    function login_page() {        $is_logged_in = $this->CI->session->userdata('is_logged_in');        if ($is_logged_in) {            return true;        } else {            return false;        }    }    function fill_session($info) {        $session_data = array(            'user_id' => $info['id'],            'username' => $info['username'],            'last_loggenin_date' => $info['logging_date'],            'is_logged_in' => TRUE        );        $this->CI->session->set_userdata($session_data);    }    function logout() {        $this->CI->session->sess_destroy();        redirect(base_url() . 'admin/users/login', 'location');    }    public function getTheme() {        $theme = get_cookie('customTheme');        if (is_null($theme) || empty($theme) || !isset($theme))            return "style_default";        else            return $theme;    }    public function addSalt($plainText) {        return md5($this->CI->config->item('salt') . $plainText);    }}/* End of custom library, Auth.php */